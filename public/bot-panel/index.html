<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bot Panel Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="static/style.css">
</head>
<body class="bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-white">
    <div id="app" class="h-screen flex flex-col" style="display: none;" :style="appStyle">
        <!-- Header -->
        <header class="bg-black bg-opacity-30 backdrop-filter backdrop-blur-lg border-b border-white border-opacity-20 p-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <h1 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                        <i class="fas fa-robot mr-2"></i>Bot Panel Dashboard
                    </h1>
                    <!-- <div class="flex items-center space-x-2">
                        <div :class="['status-indicator', ws && ws.readyState === 1 ? 'status-connected' : 'status-disconnected']"></div>
                        <span class="text-sm">{{ ws && ws.readyState === 1 ? 'Connected' : 'Disconnected' }}</span>
                    </div> -->
                </div>
                <!-- <div class="text-sm text-gray-300">
                    <i class="fas fa-clock mr-2"></i>{{ new Date().toLocaleTimeString() }}
                </div> -->
                <div class="flex items-center space-x-2">
                    <div :class="['status-indicator', ws && ws.readyState === 1 ? 'status-connected' : 'status-disconnected']"></div>
                    <span class="text-sm">{{ ws && ws.readyState === 1 ? 'Connected' : 'Disconnected' }}</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="flex-1 flex overflow-hidden">
            <!-- Left Panel - Controls -->
            <div class="w-80 bg-black bg-opacity-30 backdrop-filter backdrop-blur-lg border-r border-white border-opacity-20 p-6 overflow-y-auto">
                <!-- Timer Section -->
                <div class="card p-4 mb-6">
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <i class="fas fa-stopwatch mr-2 text-blue-400"></i>Timer
                    </h3>
                    <div class="space-y-3">
                        <div class="text-2xl font-mono text-center py-2 bg-gray-800 rounded-lg">
                            {{ formattedTime || '00:00:00' }}
                        </div>
                        <button @click="setPauseTimer" :class="['w-full py-2 px-4 rounded-lg text-white font-medium', outputPauseTimer ? 'btn-success' : 'btn-primary']">
                            <i :class="['fas mr-2', outputPauseTimer ? 'fa-play' : 'fa-pause']"></i>
                            {{ outputPauseTimer ? 'Resume' : 'Pause' }}
                        </button>
                    </div>
                </div>

                <!-- Worker Management -->
                <div class="card p-4 mb-6">
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <i class="fas fa-users mr-2 text-green-400"></i>Workers
                    </h3>
                    <div class="space-y-3">
                        <div class="text-center">
                            <span class="text-3xl font-bold text-green-400">{{ outputNumWorkers || 0 }}</span>
                            <p class="text-sm text-gray-300">Active Workers</p>
                        </div>
                        <div class="grid grid-cols-2 gap-2">
                            <button @click="removeWorker" class="btn-secondary py-2 px-3 rounded-lg text-white font-medium text-sm">
                                <i class="fas fa-minus mr-1"></i>Remove
                            </button>
                            <button @click="addWorker" class="btn-success py-2 px-3 rounded-lg text-white font-medium text-sm">
                                <i class="fas fa-plus mr-1"></i>Add
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Process Control -->
                <div class="card p-4 mb-6">
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <i class="fas fa-cogs mr-2 text-purple-400"></i>Process
                    </h3>
                    <button @click="setProcess" :class="['w-full py-3 px-4 rounded-lg text-white font-medium', outputProcess ? 'btn-secondary' : 'btn-success']">
                        <i :class="['fas mr-2', outputProcess ? 'fa-stop' : 'fa-play']"></i>
                        {{ outputProcess ? 'Stop Process' : 'Start Process' }}
                    </button>
                    <label class="inline-flex items-center cursor-pointer mt-2">
                        <span class="mr-2">Reset Session</span>
                        <div class="relative">
                            <input type="checkbox" v-model="inputResetSession" class="sr-only peer" />
                            <div class="w-5 h-5 border-2 border-gray-300 rounded-md peer-checked:bg-green-400 peer-checked:border-green-400 flex items-center justify-center transition-colors">
                            <svg class="w-3 h-3 text-white hidden peer-checked:block" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                            </svg>
                            </div>
                        </div>
                    </label>
                </div>

                <!-- Scheduler Interval -->
                <div class="card p-4 mb-6">
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <i class="fas fa-calendar-alt mr-2 text-yellow-400"></i>Scheduler
                    </h3>
                    <div class="space-y-3">
                        <input 
                            v-model.number="outputSchedulerInterval" 
                            type="number" 
                            min="1"
                            placeholder="Interval (ms)"
                            class="glass-input w-full p-2 rounded-lg text-white placeholder-gray-400"
                        />
                        <button @click="setSchedulerInterval" class="btn-primary w-full py-2 px-4 rounded-lg text-white font-medium">
                            <i class="fas fa-clock mr-2"></i>Set Interval
                        </button>
                    </div>
                </div>

                <!-- Settings -->
                <div class="card p-4">
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <i class="fas fa-cog mr-2 text-gray-400"></i>Settings
                    </h3>
                    <div class="space-y-2">
                        <button @click="impotGeos" class="btn-primary w-full py-2 px-3 rounded-lg text-white font-medium text-sm">
                            <i class="fas fa-map mr-2"></i>Import Geographies
                        </button>
                        <button @click="setTasks" class="btn-primary w-full py-2 px-3 rounded-lg text-white font-medium text-sm">
                            <i class="fas fa-tasks mr-2"></i>Set Tasks
                        </button>
                        <button @click="setSaveJsonDb" :class="['w-full py-2 px-3 rounded-lg text-white font-medium text-sm', outputSaveJsonDb ? 'btn-secondary' : 'btn-success']">
                            <i class="fas fa-database mr-2"></i>{{ outputSaveJsonDb ? 'Disable' : 'Enable' }} Save Json DB
                        </button>

                        <button @click="setSaveJsonFile" :class="['w-full py-2 px-3 rounded-lg text-white font-medium text-sm', outputSaveJsonFile ? 'btn-secondary' : 'btn-success']">
                            <i class="fas fa-file mr-2"></i>{{ outputSaveJsonFile ? 'Disable' : 'Enable' }} Save Json File
                        </button>
                        <button @click="setVerboseLog" :class="['w-full py-2 px-3 rounded-lg text-white font-medium text-sm', outputVerboseLog ? 'btn-secondary' : 'btn-success']">
                            <i class="fas fa-eye mr-2"></i>{{ outputVerboseLog ? 'Disable' : 'Enable' }} Verbose
                        </button>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Terminal and Tasks -->
            <div class="flex-1 flex flex-col overflow-hidden">
                <!-- Task Status -->
                <div class="bg-black bg-opacity-30 backdrop-filter backdrop-blur-lg border-b border-white border-opacity-20 p-4">
                    <h3 class="text-lg font-semibold mb-3 flex items-center">
                        <i class="fas fa-list mr-2 text-orange-400"></i>Active Tasks
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 max-h-32 overflow-y-auto">
                        <div v-for="item in outputNumTasks" :key="item.id" 
                             class="bg-gray-800 bg-opacity-50 rounded-lg p-3 flex items-center justify-between">
                            <span class="font-mono text-sm text-blue-300">{{ item.id }}</span>
                            <span class="font-bold text-green-400">{{ item.data }}</span>
                        </div>
                        <div v-if="outputNumTasks.length === 0" class="col-span-full text-center text-gray-400 py-4">
                            <i class="fas fa-inbox text-3xl mb-2"></i>
                            <p>No active tasks</p>
                        </div>
                    </div>
                </div>

                <!-- Terminal -->
                <div class="flex-1 relative flex flex-col overflow-hidden">
                    <div class="sticky top-4 z-10 bg-black p-2">
                        <h3 class="text-lg font-semibold flex items-center text-green-400">
                            <i class="fas fa-terminal fa-sm mr-2 ml-1"></i>System Log
                        </h3>
                    </div>
                    <div ref="terminal" class="flex-1 terminal pt-5 overflow-auto" @scroll="handleScroll">{{ outputLog || 'Waiting for connection...' }}</div>
                </div>
            </div>
        </div>
    </div>
    <script src="static/script.js"></script>
</body>
</html>